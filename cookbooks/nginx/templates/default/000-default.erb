#This file is autogenerated by Chef via config. Any local changes may get overwritten.
#Last updated at <%= Time.now.to_s %>
server {
  listen   80;
  server_name  <%= node[:hostname] %>;

  access_log  <%= node[:nginx][:log_dir] %>/<%= node[:hostname] %>.access.log;
  error_log  <%= node[:nginx][:log_dir] %>/<%= node[:hostname] %>.error.log;
  root /mnt/www/sencha;
  index  index.php index.html index.htm;

  location / {
  #root   /mnt/www/sencha;
  #try_files $uri $uri/ @ee;
  gzip on;
  gzip_proxied     expired no-cache no-store private auth;
  gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;	
  if (!-e $request_filename) {
    rewrite ^(.*)$ /index.php/$1 last;
    }
  }

  location /nginxstatus {
  stub_status on;
  access_log   off;
  #This is to be polled by Cortona_agent running locally.
  allow 127.0.0.1;
  deny all;
  }

  location /images {
  root /mnt/www/sencha/images;
  autoindex off;
  }

  location /files {
  root /mnt/www/sencha/files;
  autoindex off;
  }


}

